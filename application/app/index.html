<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dsan</title>
<link href="https://fonts.googleapis.com/css2?family=Aldrich&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="src/css/style.css">
</head>

<body>



<div class="digital_watch_container">
  <div class="timer well" data-text="00:00:00">00:00:00</div>
  <div class="resume_start_btn">
    <div class="toggle green" onClick="$('.timer').countimer('resume');">
      <input type="checkbox">
      <span class="button"></span>
    </div>
    <div class="toggle yellow" onClick="$('.timer').countimer('stop');">
      <input type="checkbox">
      <span class="button"></span>
    </div>
    <div class="toggle red" onClick="$('.timer').countimer('start');">
      <input type="checkbox">
      <span class="button"></span>
    </div>
    <div class="d_logo">
      <img src="src/img/d_logo.png">
    </div>
  </div>
</div>

<div id="myMeetingIdModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-body">
        <div class="alert alert-success alert-dismissible fade hide" role="alert" id="success">
          
        </div>
        <div class="alert alert-danger alert-dismissible fade hide" role="alert" id="danger">
        
        </div>

        <form name="meetingForm" id="meetingForm" method="POST" novalidate="novalidate" onsubmit="return false">
          <div class="form-group control-group">
            <label for="meetingId">Meeting Id</label>
            <input type="text" class="form-control" id="meetingId" name="meetingId" placeholder="Please enter meetingId" required>
            <span class="help-block"></span>
          </div>
          <div class="form-group control-group">
            <label for="meetingPassword">Meeting Password</label>
            <input type="password" class="form-control" id="meetingPassword" name="meetingPassword" placeholder="Please enter password" required>
            <span class="help-block"></span>
          </div>
          <div class="form-group text-center">
            <button type="submit" class="btn btn-primary" id="meetingBtn">Submit</button>
          </div>
        </form>
      </div>
    </div>

  </div>
</div>

<div id="messageModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-body">

        <div class="alert alert-success alert-dismissible fade hide" role="alert" id="msgSuccess">
          
        </div>
        <div class="alert alert-danger alert-dismissible fade hide" role="alert" id="msgDanger">
        
        </div>

      </div>
    </div>

  </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqBootstrapValidation/1.3.7/jqBootstrapValidation.min.js"></script> 

<!-- <script src="dist/ez.countimer.js"></script> -->

<script type="text/javascript">

    $(document).ready(function() { 
      $("#myMeetingIdModal").modal('show');      
    });

    $('#myMeetingIdModal').modal({backdrop: 'static', keyboard: false});
    
    $(document).ready(function(){
	
      $("#meetingForm").find("input,textarea,select,radio,checkbox").jqBootstrapValidation({
        preventSubmit: true,
        submitError: function($form, event, errors) {},
        submitSuccess: function($form, event) {
          meetingId = $("#meetingId").val();
          meetingPassword = $("#meetingPassword").val();
          $.ajax({
              url: "http://35.245.107.78/api/meeting-details",
              data: {meetingId: meetingId, meetingPassword: meetingPassword},
              type: 'POST',
              success: function(response) {
                response = JSON.parse(response);
                if (response.response) 
                {
                  
                  $("#danger").removeClass('show').addClass('hide');
                  $("#success").html(response.message);
                  $("#success").removeClass('hide').addClass('show');
                  setTimeout(function() {
                    $("#success").removeClass('show').addClass('hide');
                    $("#myMeetingIdModal").modal('hide');
                    $("#msgDanger").removeClass('show').addClass('hide');
                    $("#msgSuccess").html(response.message);
                    $("#msgSuccess").removeClass('hide').addClass('show');
                    if(response.instant)
                    {
                      $("#messageModal").modal('show');
                    }
                  }, 1000);

                  setTimeout(function() {
                    $("#messageModal").modal('hide');
                  }, response.afterstart);

                  setTimeout(function() {
                    var seconds = response.mseconds;
                    var interval = setInterval(function() {
                      var hoursLeft   = Math.floor((seconds));
                      var hours       = Math.floor(hoursLeft/3600);
                      var minutesLeft = Math.floor((hoursLeft) - (hours*3600));
                      var minutes     = Math.floor(minutesLeft/60);
                      var remainingSeconds = seconds % 60;
                      function pad(n) {
                        return (n < 10 ? "0" + n : n);
                      }
                      $(".timer").html(pad(hours) + ":" + pad(minutes) + ":" + pad(remainingSeconds));
                      if (seconds == 0) {
                        clearInterval(countdownTimer);
                      } else {
                        seconds--;
                      }
                    }, 1000);
                  }, response.afterstart);
                }else 
                {
                  $("#success").removeClass('show').addClass('hide');
                  $("#danger").html(response.message);
                  $("#danger").removeClass('hide').addClass('show');
                  setTimeout(function() {
                    $("#danger").removeClass('show').addClass('hide');
                  }, 5000);
                }
              }
          });
          event.preventDefault();
        },
        filter: function() {
          return $(this).is(":visible");
        }
     });
    });

</script>
</body>
</html>
